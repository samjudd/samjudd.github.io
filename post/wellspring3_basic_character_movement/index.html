<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Wellspring 3: Basic Character Movement | Sam Judd</title><meta name=keywords content><meta name=description content="Quick update for now, I was able to get character movement working last week, as well as cleaning up a lot of the code that I had to make the interface a little easier to use and expose the right things. From a couple weeks ago, I had left 5 goals for the next steps in the game. I did pretty well, and this update finishes off goals 1-3 and goal 5 listed below (from the end of last post)."><meta name=author content="Sam Judd"><link rel=canonical href=https://samjudd.github.io/post/wellspring3_basic_character_movement/><link crossorigin=anonymous href=/assets/css/stylesheet.min.d9015f4cb657fd3539b79b29ffbd11de4175ccd105ad7591beffaadfafb48488.css integrity="sha256-2QFfTLZX/TU5t5sp/70R3kF1zNEFrXWRvv+q36+0hIg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://samjudd.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://samjudd.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://samjudd.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://samjudd.github.io/apple-touch-icon.png><link rel=mask-icon href=https://samjudd.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><link rel=preconnect href=https://stats.judd.blue><script defer data-domain=samjudd.github.io src=https://stats.judd.blue/js/plausible.js></script><script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script><script></script><meta property="og:title" content="Wellspring 3: Basic Character Movement"><meta property="og:description" content="Quick update for now, I was able to get character movement working last week, as well as cleaning up a lot of the code that I had to make the interface a little easier to use and expose the right things. From a couple weeks ago, I had left 5 goals for the next steps in the game. I did pretty well, and this update finishes off goals 1-3 and goal 5 listed below (from the end of last post)."><meta property="og:type" content="article"><meta property="og:url" content="https://samjudd.github.io/post/wellspring3_basic_character_movement/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-04-18T14:44:03-07:00"><meta property="article:modified_time" content="2021-04-18T14:44:03-07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Wellspring 3: Basic Character Movement"><meta name=twitter:description content="Quick update for now, I was able to get character movement working last week, as well as cleaning up a lot of the code that I had to make the interface a little easier to use and expose the right things. From a couple weeks ago, I had left 5 goals for the next steps in the game. I did pretty well, and this update finishes off goals 1-3 and goal 5 listed below (from the end of last post)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://samjudd.github.io/post/"},{"@type":"ListItem","position":2,"name":"Wellspring 3: Basic Character Movement","item":"https://samjudd.github.io/post/wellspring3_basic_character_movement/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Wellspring 3: Basic Character Movement","name":"Wellspring 3: Basic Character Movement","description":"Quick update for now, I was able to get character movement working last week, as well as cleaning up a lot of the code that I had to make the interface a little easier to use and expose the right things. From a couple weeks ago, I had left 5 goals for the next steps in the game. I did pretty well, and this update finishes off goals 1-3 and goal 5 listed below (from the end of last post).","keywords":[],"articleBody":"Quick update for now, I was able to get character movement working last week, as well as cleaning up a lot of the code that I had to make the interface a little easier to use and expose the right things. From a couple weeks ago, I had left 5 goals for the next steps in the game. I did pretty well, and this update finishes off goals 1-3 and goal 5 listed below (from the end of last post).\n Able to move from hex center to hex center along the paths determined by Dijkstra’s algorithm. Show its attack range. Store custom properties for the particular character. Be able to be selected and deselected. Reset its movement/action points upon a new turn.  Character Selection In order to select characters, I decided to create 2 classes, a GameManager class that oversees all the characters in the game and a Character class that has one instance for each character. Character can be both used as a template for making more advanced classes for the actual game and used on its own for testing (which is what I’m doing now). Each Character can also store custom properties as well as it’s own movement points. Character then defines an OnTurnEnd() function that is common to all characters that is called when the turn ends and is used to reset action points and do any other actions. An OnTurnStart() function will likely also be used but not implementing it yet until I have a use for it.\nIn order to then select one of these characters, the GameManager monitors for when the map is clcked and when it is gets from the map what tile was selected. Each tile stores if there is a character on it and if so what character ID number, and so from there the right character can be pulled from a character list also stored in the GameManager. When a character is selected, the movement algorithm is automatically run to show their movement range. At the moment for testing, each character is shown with 8 movement points, where a tile costs 2 to move across and a forest tile costs 4.\nCharacter Movement Character movement was pretty straightforward to implement. I first changed the way the pathfinding algorithm worked slightly so it returned the dictionary it created for pathfinding. This dictionary contains each hex that was visited by the algorithm along with the hex the algorithm (Dijkstra) came from. This makes it possible to basically start at the destination, which we know must be in the searched locations since otherwise it can’t be selected, and backtrace to the start and return that path. Once the path is created, each node to travel to is put into a queue. This queue is then used in the Process() (runs every frame) function to control where to travel to.\nIn the Process() function, a linear interpolation is used to move the character sprite between its current location and the next one from the queue of locations to travel to. Once the sprite gets to each location, the next one is pulled from the queue and the sprite is moved until the queue is empty. At this point the move is complete.\nAn improvement I’d like to make at some point is to change the interpolation scheme from a linear interpolation to a different one. A different movement scheme (for example a quadratic interpolation instead of a linear one) might do a better job of making the movement seem more natural. At the moment however I’m more interested in just having a minimum viable product, so I’d rather spend my time creating new features rather than polishing ones I already have in a functional state.\nImplementation Video A video of the implementation is shown below. I still need to get to implementing a UI, so it’s a bit hard to tell at the moment what is going on, I’ve added some notes in the video to try to make it clearer.\n  Next Steps Now that I have some basic movement down, my development options have opened up a little bit. I’ve identified a couple key categories of things I need to flesh out next, listed below. Look for my next update to be in one of these areas.\n Character attacking, attack range, and hitpoints, as well as making a target dummy. Basic UI development for seeing character HP, movement points, turn end button, etc.  Once I get both of these tasks done, this should finish out the basic tools necessary to start creating some unique characters and creating a full map. Will be able to get into the actual game design at that point and give some more interesting thoughts than just implementation details, so very excited for that. As always, thanks for reading, and the source code for this can be checked out on my github here.\n","wordCount":"814","inLanguage":"en","datePublished":"2021-04-18T14:44:03-07:00","dateModified":"2021-04-18T14:44:03-07:00","author":{"@type":"Person","name":"Sam Judd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://samjudd.github.io/post/wellspring3_basic_character_movement/"},"publisher":{"@type":"Organization","name":"Sam Judd","logo":{"@type":"ImageObject","url":"https://samjudd.github.io/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: #1d1e20;--entry: #2e2e33;--primary: rgba(255, 255, 255, 0.84);--secondary: rgba(255, 255, 255, 0.56);--tertiary: rgba(255, 255, 255, 0.16);--content: rgba(255, 255, 255, 0.74);--hljs-bg: #2e2e33;--code-bg: #37383e;--border: #333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://samjudd.github.io/ accesskey=h title="Sam Judd (Alt + H)">Sam Judd</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Wellspring 3: Basic Character Movement</h1><div class=post-meta>April 18, 2021&nbsp;·&nbsp;Sam Judd</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#character-selection aria-label="Character Selection">Character Selection</a></li><li><a href=#character-movement aria-label="Character Movement">Character Movement</a></li><li><a href=#implementation-video aria-label="Implementation Video">Implementation Video</a></li><li><a href=#next-steps aria-label="Next Steps">Next Steps</a></li></ul></div></details></div><div class=post-content><p>Quick update for now, I was able to get character movement working last week, as well as cleaning up a lot of the code that I had to make the interface a little easier to use and expose the right things.
From a couple weeks ago, I had left 5 goals for the next steps in the game.
I did pretty well, and this update finishes off goals 1-3 and goal 5 listed below (from the end of last post).</p><ol><li>Able to move from hex center to hex center along the paths determined by Dijkstra&rsquo;s algorithm.</li><li>Show its attack range.</li><li>Store custom properties for the particular character.</li><li>Be able to be selected and deselected.</li><li>Reset its movement/action points upon a new turn.</li></ol><h2 id=character-selection>Character Selection<a hidden class=anchor aria-hidden=true href=#character-selection>#</a></h2><p>In order to select characters, I decided to create 2 classes, a <code>GameManager</code> class that oversees all the characters in the game and a <code>Character</code> class that has one instance for each character.
<code>Character</code> can be both used as a template for making more advanced classes for the actual game and used on its own for testing (which is what I&rsquo;m doing now).
Each <code>Character</code> can also store custom properties as well as it&rsquo;s own movement points.
<code>Character</code> then defines an <code>OnTurnEnd()</code> function that is common to all characters that is called when the turn ends and is used to reset action points and do any other actions.
An <code>OnTurnStart()</code> function will likely also be used but not implementing it yet until I have a use for it.</p><p>In order to then select one of these characters, the <code>GameManager</code> monitors for when the map is clcked and when it is gets from the map what tile was selected.
Each tile stores if there is a character on it and if so what character ID number, and so from there the right character can be pulled from a character list also stored in the <code>GameManager</code>.
When a character is selected, the movement algorithm is automatically run to show their movement range.
At the moment for testing, each character is shown with 8 movement points, where a tile costs 2 to move across and a forest tile costs 4.</p><h2 id=character-movement>Character Movement<a hidden class=anchor aria-hidden=true href=#character-movement>#</a></h2><p>Character movement was pretty straightforward to implement.
I first changed the way the pathfinding algorithm worked slightly so it returned the dictionary it created for pathfinding.
This dictionary contains each hex that was visited by the algorithm along with the hex the algorithm (Dijkstra) came from.
This makes it possible to basically start at the destination, which we know must be in the searched locations since otherwise it can&rsquo;t be selected, and backtrace to the start and return that path.
Once the path is created, each node to travel to is put into a queue.
This queue is then used in the <code>Process()</code> (runs every frame) function to control where to travel to.</p><p>In the <code>Process()</code> function, a linear interpolation is used to move the character sprite between its current location and the next one from the queue of locations to travel to.
Once the sprite gets to each location, the next one is pulled from the queue and the sprite is moved until the queue is empty.
At this point the move is complete.</p><p>An improvement I&rsquo;d like to make at some point is to change the interpolation scheme from a linear interpolation to a different one.
A different movement scheme (for example a quadratic interpolation instead of a linear one) might do a better job of making the movement seem more natural.
At the moment however I&rsquo;m more interested in just having a minimum viable product, so I&rsquo;d rather spend my time creating new features rather than polishing ones I already have in a functional state.</p><h2 id=implementation-video>Implementation Video<a hidden class=anchor aria-hidden=true href=#implementation-video>#</a></h2><p>A video of the implementation is shown below.
I still need to get to implementing a UI, so it&rsquo;s a bit hard to tell at the moment what is going on, I&rsquo;ve added some notes in the video to try to make it clearer.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/py6jiAbyPAE style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=next-steps>Next Steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h2><p>Now that I have some basic movement down, my development options have opened up a little bit.
I&rsquo;ve identified a couple key categories of things I need to flesh out next, listed below.
Look for my next update to be in one of these areas.</p><ol><li>Character attacking, attack range, and hitpoints, as well as making a target dummy.</li><li>Basic UI development for seeing character HP, movement points, turn end button, etc.</li></ol><p>Once I get both of these tasks done, this should finish out the basic tools necessary to start creating some unique characters and creating a full map.
Will be able to get into the actual game design at that point and give some more interesting thoughts than just implementation details, so very excited for that.
As always, thanks for reading, and the source code for this can be checked out on my github <a href=https://github.com/samjudd/wellspring3>here</a>.</p></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://samjudd.github.io/>Sam Judd</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu')
menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>